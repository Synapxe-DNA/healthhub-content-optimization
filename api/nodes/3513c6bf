{
  "code": "def standardize_columns(\n    all_contents: dict[str, Callable[[], Any]],\n    columns_to_add_cfg: dict[str, list[str]],\n    columns_to_keep_cfg: dict[str, list[str]],\n    default_columns: list[str],\n) -> dict[str, pd.DataFrame]:\n    \"\"\"\n    Standardizes the columns of multiple dataframes in a dictionary.\n\n    This function takes in a dictionary of dataframes, where each dataframe is associated with a filename.\n    It then standardizes the columns of each dataframe by performing the following steps:\n\n    1. Get the content category from the filename.\n    2. Load the dataframe using the provided partition function.\n    3. Standardize the column names by selecting and renaming the columns.\n    4. Mark articles with no content or with dummy content in the `to_remove` column.\n    5. Add the standardized dataframe to the `all_contents_standardized` dictionary.\n\n    The function returns a dictionary mapping content categories to the standardized dataframes.\n\n    Args:\n        all_contents (dict[str, Callable[[], Any]]):\n            A dictionary containing the raw `partitions.PartitionedDataset`where the keys are the filenames and the\n            values loads the raw excel data as `pandas.DataFrame`.\n\n        columns_to_add_cfg (dict[str, list[str]]):\n            A dictionary mapping content categories to lists of column names to add.\n\n        columns_to_keep_cfg (dict[str, list[str]]):\n            A dictionary mapping content categories to lists of column names to keep.\n\n        default_columns (list[str]):\n            A list of default column names to rename the columns of the dataframes to.\n\n    Returns:\n        dict[str, pd.DataFrame]:\n            A dictionary that contains the standardized dataframes stored as partitioned parquet files, where the keys\n            are the content categories and the values are the corresponding dataframes.\n    \"\"\"\n    all_contents_standardized = {}\n\n    pbar = tqdm(all_contents.items())\n\n    for filename, partition_load_func in pbar:\n        # Get content category from filename\n        content_category = re.sub(r\"export-published-\", \"\", filename.split(\"_\")[0])\n        pbar.set_description(f\"Standardizing: {content_category}\")\n\n        # Load partition data\n        df = partition_load_func()\n\n        # Standardize column names\n        columns_to_add = columns_to_add_cfg.get(content_category, None)\n        columns_to_keep = columns_to_keep_cfg.get(content_category, None)\n\n        # Standardize columns\n        df = select_and_rename_columns(\n            df, columns_to_add, columns_to_keep, default_columns, content_category\n        )\n\n        # Strip all whitespaces across all strings in dataframe\n        # See: https://github.com/Wilsven/healthhub-content-optimization/issues/53\n        df = df.map(lambda x: x.strip() if isinstance(x, str) else x)\n\n        all_contents_standardized[content_category] = df\n\n    return all_contents_standardized\n",
  "filepath": "content-optimization/src/content_optimization/pipelines/data_processing/nodes.py",
  "parameters": {
    "columns_to_add": {
      "program-sub-pages": [
        "ProgramSubPages_ArticleCatNames",
        "ProgramSubPages_DateModified"
      ],
      "programs": [
        "Programs_DateModified"
      ]
    },
    "columns_to_keep": {
      "cost-and-financing": [
        "id",
        "Content.Name",
        "CostAndFinancing_Title",
        "CostAndFinancing_ArticleCatNames",
        "CostAndFinancing_CoverImgUrl",
        "CostAndFinancing_FullUrl",
        "CostAndFinancing_FullUrl2",
        "CostAndFinancing_FriendlyUrl",
        "CostAndFinancing_CategoryDesc",
        "CostAndFinancing_ContentBody",
        "CostAndFinancing_ENKeywords",
        "CostAndFinancing_FeatureTitle",
        "CostAndFinancing_PRName",
        "CostAndFinancing_AlternateImageText",
        "CostAndFinancing_DateModified",
        "CostAndFinancing_NumberofViews",
        "CostAndFinancing_LastMonthViewCount",
        "CostAndFinancing_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "diseases-and-conditions": [
        "id",
        "Content.Name",
        "DiseasesCondition_Title",
        "DiseasesCondition_ArticleCatNames",
        "DiseasesCondition_CoverImgUrl",
        "DiseasesCondition_FullUrl",
        "DiseasesCondition_FullUrl2",
        "DiseasesCondition_FriendlyUrl",
        "DiseasesCondition_CategoryDesc",
        "DiseasesCondition_ContentBody",
        "DiseasesCondition_ENKeywords",
        "DiseasesCondition_FeatureTitle",
        "DiseasesCondition_PRName",
        "DiseasesCondition_AlternateImageText",
        "DiseasesCondition_DateModified",
        "DiseasesCondition_NumberOfViews",
        "DiseasesCondition_LastMonthViewCount",
        "DiseasesCondition_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "health-statistics": [
        "id",
        "Content.Name",
        "HealthStatistics_Title",
        "HealthStatistics_ArticleCatNames",
        "HealthStatistics_CoverImgUrl",
        "HealthStatistics_FullUrl",
        "HealthStatistics_FullUrl2",
        "HealthStatistics_FriendlyUrl",
        "HealthStatistics_CategoryDesc",
        "HealthStatistics_ContentBody",
        "HealthStatistics_ENKeywords",
        "HealthStatistics_FeatureTitle",
        "HealthStatistics_PRName",
        "HealthStatistics_AlternateImageText",
        "HealthStatistics_DateModified",
        "HealthStatistics_NumberOfViews",
        "HealthStatistics_LastMonthViewCount",
        "HealthStatistics_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "live-healthy-articles": [
        "id",
        "Content.Name",
        "LiveHealthyArticle_Title",
        "LiveHealthyArticle_ArticleCateName",
        "LiveHealthyArticle_CoverImgUrl",
        "LiveHealthyArticle_FullUrl",
        "LiveHealthyArticle_FullUrl2",
        "LiveHealthyArticle_FriendlyUrl",
        "LiveHealthyArticle_CategoryDes",
        "LiveHealthyArticle_Content_Body",
        "LiveHealthyArticle_ENKeywords",
        "LiveHealthyArticle_FeatureTitle",
        "LiveHealthyArticle_PRName",
        "LiveHealthyArticle_AlternateImageText",
        "LiveHealthyArticle_DateModified",
        "LiveHealthyArticle_Number_of_View",
        "LiveHealthyArticle_Lastmonthview",
        "LiveHealthyArticle_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "medical-care-and-facilities": [
        "id",
        "Content.Name",
        "MedicalCareFaci_Title",
        "MedicalCareFaci_ArticleCatNames",
        "MedicalCareFaci_CoverImgUrl",
        "MedicalCareFaci_FullUrl",
        "MedicalCareFaci_FullUrl2",
        "MedicalCareFaci_FriendlyUrl",
        "MedicalCareFaci_CategoryDesc",
        "MedicalCareFaci_ContentBody",
        "MedicalCareFaci_ENKeywords",
        "MedicalCareFaci_FeatureTitle",
        "MedicalCareFaci_PRName",
        "MedicalCareFaci_AlternateImageText",
        "MedicalCareFaci_DateModified",
        "MedicalCareFaci_NumberOfViews",
        "MedicalCareFaci_LastMonthViewCount",
        "MedicalCareFaci_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "medications": [
        "id",
        "Content.Name",
        "Medication_Title",
        "Medication_ArticleCatNames",
        "Medication_CoverImgUrl",
        "Medication_FullUrl",
        "Medication_FullUrl2",
        "Medication_FriendlyUrl",
        "Medication_CategoryDesc",
        "Medication_ContentBody",
        "Medication_ENKeywords",
        "Medication_FeatureTitle",
        "Medication_PRName",
        "Medication_AlternateImageText",
        "Medication_DateModified",
        "Medication_NumberOfViews",
        "Medication_LastMonthViewCount",
        "Medication_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "program-sub-pages": [
        "id",
        "Content.Name",
        "ProgramSubPages_Title",
        "ProgramSubPages_ArticleCatNames",
        "ProgramSubPages_CoverImgUrl",
        "ProgramSubPages_FullUrl",
        "ProgramSubPages_FullUrl2",
        "ProgramSubPages_FriendlyUrl",
        "ProgramSubPages_CategoryDes",
        "ProgramSubPages_Content_Body",
        "ProgramSubPages_ENKeywords",
        "ProgramSubPages_FeatureTitle",
        "ProgramSubPages_PRName",
        "ProgramSubPages_AlternateImageText",
        "ProgramSubPages_DateModified",
        "ProgramSubPages_Number_of_Views",
        "ProgramSubPages_Lastmonthviewcount",
        "ProgramSubPages_LastTwoMonthCount",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "programs": [
        "id",
        "Content.Name",
        "Programs_Title",
        "Programs_ArticleCateNames",
        "Programs_CoverImgUrl",
        "Programs_FullUrl",
        "Programs_FullUrl2",
        "Programs_FriendlyUrl",
        "Programs_CategoryDes",
        "Programs_Content_x0020_Body",
        "Programs_ENKeywords",
        "Programs_FeatureTitle",
        "Programs_PRName",
        "Programs_AlternateImageText",
        "Programs_DateModified",
        "Programs_Number_of_Views",
        "Programs_Lastmonthviewcount",
        "Programs_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ],
      "support-group-and-others": [
        "id",
        "Content.Name",
        "SupportGroups_Title",
        "SupportGroups_ArticleCatNames",
        "SupportGroups_CoverImgUrl",
        "SupportGroups_FullUrl",
        "SupportGroups_FullUrl2",
        "SupportGroups_FriendlyUrl",
        "SupportGroups_CategoryDesc",
        "SupportGroups_ContentBody",
        "SupportGroups_ENKeywords",
        "SupportGroups_FeatureTitle",
        "SupportGroups_PRName",
        "SupportGroups_AlternateImageText",
        "SupportGroups_DateModified",
        "SupportGroups_NumberOfViews",
        "SupportGroups_LastMonthViewCount",
        "SupportGroups_LastTwoMonthsView",
        "Page Views",
        "Engagement Rate",
        "Bounce Rate",
        "Exit Rate",
        "Scroll %",
        "% of Total Views",
        "Cumulative % of Total Views"
      ]
    },
    "default_columns": [
      "id",
      "content_name",
      "title",
      "article_category_names",
      "cover_image_url",
      "full_url",
      "full_url2",
      "friendly_url",
      "category_description",
      "content_body",
      "keywords",
      "feature_title",
      "pr_name",
      "alternate_image_text",
      "date_modified",
      "number_of_views",
      "last_month_view_count",
      "last_two_months_view",
      "page_views",
      "engagement_rate",
      "bounce_rate",
      "exit_rate",
      "scroll_percentage",
      "percentage_total_views",
      "cumulative_percentage_total_views"
    ]
  },
  "run_command": "kedro run --to-nodes='standardize_columns_node'",
  "inputs": [
    "all_contents",
    "params:columns_to_add",
    "params:columns_to_keep",
    "params:default_columns"
  ],
  "outputs": [
    "all_contents_standardized"
  ]
}